┌──────────────────┐
│           Rapture 2.4.1            │
│ Copyright (C) 2004-2020 T.Kaneyasu │
└──────────────────┘

================================================================================
● 概要 ●
画面上の指定した範囲だけをキャプチャして、最前面に表示させておくためのソフトです。
・いちいちウインドウを切り替えて比較しながら作業するのが大変
・わざわざ紙にメモするのが面倒
といった時にご利用ください。

================================================================================
● 動作環境 ●
Windows95以降のOSで、65536色以上表示可能な環境なら動くはずです。

================================================================================
● インストール方法 ●
インストーラはありません。
適当なフォルダを作って、そこに解凍してください。

また、設定を起動時の作業フォルダに保存します。
ランチャ等に登録する場合は、作業フォルダも設定してください。

================================================================================
● アンインストール方法 ●
インストール時に作成したフォルダごと削除してください。
また、設定ファイル(rapture.ini)が出来ていれば、それも削除してください。

================================================================================
● 使い方 ●
起動するとマウスカーソルが変わり、領域選択モードになります。
ドラッグで領域を選択するとウインドウが表示されます。

○ 領域選択時の操作
  ドラッグ
    キャプチャ領域を選択します。
    ドラッグ中、画面にゴミが残った場合は、Shiftを押しながらボタンを離すと、
    画面上のゴミを一旦クリアしてからキャプチャします。
  左クリック
    クリックした位置にあるウインドウ全体をキャプチャします。
    Ctrlを押しながらクリックすると、タイトルバーやウインドウ枠を取り除いてキャプチャします。
  右クリック
    領域選択をキャンセルし、終了します。

○ ウインドウ表示時の操作(マウスの操作は設定で変更できます)
  カーソルキーまたはドラッグ
    画像をスクロールします(ウインドウを縮めているときのみ)。
  Ctrlキーを押しながらドラッグ
    画像に線を引きます。
    さらにShiftを押している間は水平/垂直方向に直線を引きます。
  Shiftキーを押しながらドラッグ
    画像の一部を選択します。
    ドラッグせずにボタンを離すと選択解除します。
    後述のぶっこ抜き・トリミングに使用します。
  ダブルクリック
    一定時間ウインドウを隠します。
  右クリック
    メニューを表示します。
  PageUp/Downまたはホイール回転
    ウインドウを半透明にします(Windows2000以降)。
  Ctrlキーを押しながらPageUp/Downまたはホイール回転
    画像の表示倍率を変更します。
  1〜5キー
    画像の表示倍率を100〜500%に変更します。
  F1〜F6キー
    画像に描く線や文字の色を変更します。
  Ctrl+F1〜F4キー
    画像に描く線の幅を変更します。

○ メニューについて
  [ファイル]
    [開く...]
      画像ファイルを開きます。
    [保存...]
      画像を保存します。
    [自動保存フォルダを開く]
      自動保存フォルダが設定されている場合、そのフォルダを開きます。
    [印刷...]
      画像を印刷します。
  [編集]
    [元に戻す]
      線を引いたり文字を書いたりしたのを取り消します。
    [やり直し]
      [元に戻す]で戻す前の状態に戻します。
    [コピ]
      画像をクリップボードにコピーします。
    [ペ]
      画像をクリップボードから貼り付けます。
    [横ぶっこ抜き]
      選択範囲とその左右をぶっこ抜きます。
    [縦ぶっこ抜き]
      選択範囲とその上下をぶっこ抜きます。
    [トリミング]
      選択範囲の外側を取り除きます。
  [回転・反転]
    [左回転]
      画像を90度左回転します(Windows2000以降)。
    [右回転]
      画像を90度右回転します(Windows2000以降)。
    [任意の回転]
      画像を指定した角度で回転します(Windows2000以降)。
    [左右反転]
      画像を左右反転します。
    [上下反転]
      画像を上下反転します。
  [連結]
    画像の上下左右にクリップボードの画像を連結します。
  [再キャプ]
    再度領域選択しなおします。
  [自身をキャプ]
    ウィンドウに表示されている内容でキャプチャしなおします。
  [テキスト...]
    テキスト入力画面を開きます。
  [色]
    画像に描く線や文字の色を変更します。
  [線幅]
    画像に描く線の幅を変更します。
  [蛍光ペン]
    画像に描く線を蛍光ペン風に変更します。
  [ズーム]
    画像の表示倍率を変更します。
  [常に手前に表示]
    チェックを付けると常に手前に表示されます。
  [ピッタリ合わす]
    ウインドウサイズを画像サイズに合わせます。
  [タイトル変更...]
    画像のタイトルを変更します。
  [設定...]
    設定画面を開きます。
  [バージョン情報...]
    バージョンや著作権情報を表示します。
  [終了]
    ウィンドウを閉じます。

  ちなみに[色]の上に表示されているのは、現在の設定で描かれる線の見本です。

○ テキスト入力画面について
  上のテキスト欄に入力したテキストが、そのまま画像に描画されます。
  その下のプレビュー上をクリックまたはドラッグすると、テキストの描画位置を変更できます。

○ 設定画面について
  [全般]
    [タイトルの書式]
      タイトルバーに表示する文字列の書式です。
      後述の特殊文字が使用できます。
    [領域選択中に座標を表示する]
      チェックを付けると、領域選択中に座標を表示するようになります。
    [自動でコピー]
      キャプチャ時に自動で画像をクリップボードにコピーします。
    [ズームを綺麗に]
      表示倍率変更時の画像をちょっと綺麗にします(Windows2000以降)。
    [おにぎり嫌い]
      アイコンやカーソルを変更します。
      一部は次回起動後に変更されます。
    [キャプチャ後は最前面に表示する]
      チェックをつけると、ウィンドウが自動的に最前面に表示されます。
    [Escで終了]
      チェックをつけると、Escキーでウィンドウを閉じるようになります。
    [ウィンドウが隠れる時間]
      ダブルクリック(デフォルト)で隠れる時間をミリ秒単位で指定してください。
    [キャプチャ方式]
      Type A:
        メッセージフックを使用しないので、他のアプリケーションとの相性問題が発生しにくくなります。
        キャプチャ前に準備時間があるので、Type Bよりもレスポンスが悪くなります。
        キャプチャ中は画面が静止します。
        Windows ME以前のPCでオススメです。
      Type B:
        ※※※ Windows Vista以降でAero有効時は選択しないてください。※※※
        メッセージフックを使用するので、他のアプリケーション(常駐物やネットゲーム等)との相性で、
        うまく動作しないことがあります。
        Type Aよりもレスポンスが良くなります。
        キャプチャ中も画面は更新されます。
      Type C:
        ※※※ Windows Me以前では選択しないてください。※※※
        メッセージフックを使用しないので、他のアプリケーションとの相性問題が発生しにくくなります。
        キャプチャ中は画面が暗くなります。
        Windows Vista以降のPCでオススメです。
    [キャプチャ準備時間]
      キャプチャ画像にゴミが残るのを防ぐため、Windowsの再描画が終わるのを待つ時間です。
      Shiftを押しながらキャプチャした場合や、Type Aでキャプチャする場合は、
      ここで指定した時間だけ待ってからキャプチャします。
      レスポンスが悪いと感じる人は少し短めにしてください。
      キャプチャ画面にゴミが残る場合は少し長めにしてください。
    [背景色]
      ウィンドウの背景色です。
      画像連結時の余白部分にも適用されます。
  [描画]
    [アンドゥ回数]
      元に戻したりやり直したりできる最大回数です。
    [標準の描画設定]
      画像に描く線や文字のデフォルト設定です。
      起動直後はこの設定が使われます。
  [保存]
    [標準ファイル名]
      画像を保存する際の標準ファイル名です。
      後述の特殊文字が使用できます。
    [標準フォーマット]
      画像保存時に標準で選択される保存形式です。
    [JPEG品質]
      JPEG形式で保存するときの画質です。
      値が大きいほど画質が良くなりますが、ファイルサイズは大きくなります。
    [PNG圧縮率]
      PNG形式で保存するときの圧縮率です。
      値が大きいほどファイルサイズは小さくなりますが、処理時間は長くなります。
      画質は変わりません。
    [自動保存]
      [フォルダ]
        自動保存先のフォルダです。
        後述の特殊文字が使用できます。
        ファイル名は保存時に付加されます。
        このフォルダを設定すると、保存していない画像を破棄する前(読み込み・貼り付け・再キャプ・終了時)に自動保存します。
        保存したくない場合は、Shiftキーを押していると自動保存がキャンセルされます。
        フォルダを設定しなければ(入力欄が空なら)、自動保存は行いません。
      [履歴]
        自動保存したファイルを残しておく日数です。
        保存時刻から指定した日数が経過すると自動的に削除されます。
        0にすると削除しません(HDD容量にご注意ください)。
        削除は自動保存のタイミングで、自動保存したフォルダに対してのみ行われます。
        フォルダ名に特殊文字を含む場合、過去の日付で作成されたフォルダ等は削除対象になりません。
  [カスタマイズ]
    マウス操作の割り当てを変更できます。
  [ウィンドウ]
    ウィンドウの外観を変更できます。

○設定に使用する特殊文字について
  タイトルの書式やファイル名の設定には、下記の特殊文字が使用できます。
  これらの文字は、それぞれ対応する数値等に置換されます。
  %y : 年(西暦4桁)
  %Y : 年(西暦下2桁)
  %m : 月
  %d : 日
  %h : 時
  %n : 分
  %s : 秒
  %t : 画像のタイトル
  %% : 「%」

  例えば、タイトルの書式を
  [%y/%m/%d %h:%n:%s] %t
  とすると、
  [2008/01/23 12:34:56] キャプチャしたウインドウのタイトル
  というように変換され、キャプチャした時刻がわかるようにすることも出来ます。

  また、自動保存先フォルダを
  c:\rapture\%y-%m
  とすると、
  c:\rapture\2008-11
  というように変換され、月ごとにフォルダを分けることも出来ます。

================================================================================
● バグ・制限 ●
領域選択中(ドラッグ中)にタスクを切り替えると画面にゴミが残るので、やらないでください。
DOSプロンプトのウインドウ上だとうまく動かないようです。
Windows Vista以降でAero有効時はキャプチャ方式をType B以外にして使用してください
(Type Bに変更してしまって戻せなくなった場合は、rapture.iniを削除して設定を初期化して下さい)。

================================================================================
● 著作権等 ●
このソフトはフリーソフトです。
著作権は作者が保有しています。
使用によりユーザやPCに損害を与えるようには作っていないつもりですが、
万が一なんらかの損害が発生しても責任は負えませんので予めご了承ください。

画像の読み込み・保存に以下のライブラリを使用しています。
 libjpeg version 9c
   Copyright (C) 1991-2018 Thomas G. Lane, Guido Vollbeding
 zlib version 1.2.11
   Copyright (C) 1995-2017 Jean-loup Gailly and Mark Adler
 libpng version 1.6.37
   Copyright (C) 1995-2019 The PNG Reference Library Authors.
   Copyright (C) 2018-2019 Cosmin Truta.
   Copyright (C) 2000-2002, 2004, 2006-2018 Glenn Randers-Pehrson.
   Copyright (C) 1996-1997 Andreas Dilger.
   Copyright (C) 1995-1996 Guy Eric Schalnat, Group 42, Inc.

再配布したい場合は、
1.アーカイブのまま
2.アーカイブ内のファイル全てを一緒に(個人間での配布のみ)
のどちらかで行ってください。
どちらの場合も、ファイルの内容を変更しないでください。
販売は禁止。配布の際のメディア代等は常識の範囲内でお願いします。

================================================================================
● 連絡先 ●
https://www.knystudio.net/
mailto:info@knystudio.net

雑誌等への掲載は確認不要です。ご自由にどうぞ。
Raptureそのものの販売以外であれば商用利用も構いませんが、自己責任でお願いします。

================================================================================
● 履歴 ●
[2020/09/27] Version 2.4.1
クリックでウィンドウを選択したときに、対象ウィンドウを正しく選択できない場合があったのを修正。
セカンダリディスプレイが拡大表示になっていた場合に正しくキャプチャできなかったのを修正。
プライマリディスプレイの左にセカンダリディスプレイがある場合、右クリックの座標が正しく取得できていなかったのを修正。
バージョン情報のURLをhttpsに変更。
libpngを更新。

[2019/02/03] Version 2.4.0
アルファ付きPNGの表示を改善。
任意の回転を追加。
バージョン情報のURLを変更。
libjpeg,libpngを更新。
その他細かい修正。

[2017/06/11] Version 2.3.0
ウィンドウの外観を変更できるようにした。
Escで終了できるようにした。
メニューに終了を追加。
ウィンドウのタイトルを取得する際、対象となるウィンドウを選択範囲の中央で判定するように変更。
タイトルバーのないウィンドウでもタイトルを取得するように変更。
ファイル名等に使える文字に「%Y」を追加した(「%y」と逆な気もするけど今更変えられない…)。
スクロール時にもテキスト描画のデフォルト位置がずれていたのを修正。
zlib,libpngを更新。
その他細かい修正いろいろ。

[2016/07/09] Version 2.2.1
Windows10でウィンドウサイズが正しく取得できるように対応。
ズーム時にテキスト描画のデフォルト位置がずれていたのを修正。
印刷周りがいろいろおかしかったので作り直し。ついでに用紙サイズと向きを直接選択できるようにした。
libjpeg,libpngを更新。

[2013/12/07] Version 2.2.0
自動的に最前面にするかどうか設定できるようにした。
自身をキャプした後のUNDOがおかしかったのを修正。
キャプチャ方式Cを追加。
印刷ダイアログ表示時に画面全体が再描画されていたのを修正。
Windows Vista以降で設定によりキャプチャ時に画面が拡大表示される問題に対応。
libjpeg,zlibを更新。

[2012/08/21] Version 2.1.1
ウィンドウを最大化しているときに倍率を変えると再描画されなかったのを修正。
カスタマイズで正しく設定されない場合があったのを修正。
標準ファイル名が「\」で終わっていると保存時にエラーが出るのを修正。
範囲選択の位置がズレることがあったのを修正。
自身をキャプ機能を追加。
libjpeg,zlib,libpngを更新。

[2011/09/26] Version 2.1.0
蛍光ペン機能をつけた。
線の幅を4種類に増やした。
隠れる時間が0なら消えないようにした。
テキストのデフォルト位置をクリック位置にした。
文字の影をつけられるようにした。
背景色を設定出来るようにした。
自動コピー機能を追加。
Shiftを押してると自動保存しないようにした。自動保存のタイミングは再キャプとかペとか様々なので注意!
メニューの線見本が白の時見えないので背景色を変えるようにした。
画像回転機能を追加。
印刷マージンを保存するようにした。
自動保存フォルダを開けるようにした。
マウス操作をカスタマイズできるようにした。
Aboutのボタンの見た目を変更。
アイコン変更機能追加。
自動保存パスの最後に'\'があるとエラーが出るのを修正。
png/jpegを読み込んだ後でコピペしようとするとエラーになっていたのを修正。
コマンドラインでファイル名を指定して開いたときに最前面にならなかったのを修正。
モノクロ画像読み込んだ(貼り付けた)とき、色ペン使えないのを修正。
libjpeg,zlib,libpngを更新。

[2008/11/24] Version 2.0.0
Windows Vistaでも一応使えるようにした。
キャプチャ方式を2種類から選べるようにした。
領域選択時にその場でクリックすると、直下のウインドウ(Ctrl押しながらだとタイトルバーや枠を除いて)をキャプチャするようにした。
印刷機能を追加。
トリミング・ぶっこ抜き・画像連結機能を追加。
タイトル変更機能を追加。
標準のファイル名を設定できるようにした
自動保存機能を追加。
起動時の引数やドロップでファイルを開けるようにした。
最大倍率を500%までにした。
ショートカットキーをいろいろ設定した。
Bitmapで保存したときに他のソフトで開けないことがあったので常に24bitで保存するようにした。
その他いろいろ。

[2006/07/21] Version 1.3.0
JPEG,PNGの読み書きに対応した。
元に戻したりやり直したりできるようにした。
領域選択時にShiftを押しながらボタンを離すと、画面を一旦クリアするようにした。
領域選択キャンセル時に画面全体を消去していたのをやめた。

[2006/04/09] Version 1.2.0
ズーム機能をつけた。
テキスト描画機能をつけた。
ファイルを開いたりしたときにタイトルを変えるようにした。
領域選択キャンセルを、マウス右ボタン押したときから離したときに変更。
ファイルを開いたりするのに失敗した場合に、画面にゴミが残るのを修正。
最大化した状態でなんかするとウインドウサイズが変わってしまったりとかしていたのを修正。

[2005/12/12] Version 1.1.1
領域選択枠の描画を見直し。うまく消えないことがあったのを修正。
ファイルを開いた時およびクリップボード貼り付け時に再描画されないことがあったのを修正。
Windows95だとメニューが正しく表示されなかったのを修正。

[2005/10/10] Version 1.1.0
ダブルクリックでしばらく隠れるようにした。
Ctrl押しながらドラッグで線を引けるようにした。
ついでにスクロール時のカーソルをつけた。
開く・保存を追加。
タイトルバーが画面上端からはみ出さないようにした。
カーソルキーでスクロールするようにした。
PageUp/Downで透明度変更できるようにした。
領域選択時に座標を表示できるようにした。
キャプチャ開始したウインドウのタイトルを取得しようとするようにした。
いろいろ追加したので設定画面を作ってiniに保存するようにした。
XPスタイルに対応。
ソースを全体的に整理した。

[2004/08/24] Version 1.0.1
半透明にしてないときぐらいは、別プロセスのraptureウインドウをキャプチャできるようにした。

[2004/06/29] Version 1.0.0
タスク切り替え後に領域選択した場合、最前面表示にならなかったのを直した(たぶん)。
ポップアップメニューをつけていろいろ機能追加。
大きいアイコンを握り直した。

[2004/03/14] 試作版その2
非クライアント領域からでも領域選択出来るようにした。
領域選択時の2重起動を防止。
領域選択時のマウスカーソルを変えた。
左ドラッグで画像をスクロールできるようにした。
再描画がちょっと高速化したかも。

[2004/03/07] 試作版
とりあえず作成。
